(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{809:function(e,l,s){Promise.resolve().then(s.bind(s,9733))},9733:function(e,l,s){"use strict";s.r(l);var i=s(1844),n=s(8747),r=s(5675),d=s.n(r),a=s(5784),t=s(2920),o=s(1163);let c=e=>{var l,s,r,c,u,v,p,h,m,x,g,j,b,y;let{order:f}=e,N=o.useRouter,{updateOrder:w,error:k,clearErros:C,updated:I,setUpdated:_}=(0,a.useContext)(n.Z),[P,S]=(0,a.useState)(null==f?void 0:f.orderStatus);(0,a.useEffect)(()=>{I&&(_(!1),t.Am.success("Order Updated")),k&&(t.Am.error(k),C())},[k,I]);let O=async()=>{await w(null==f?void 0:f._id,{orderStatus:P}),_(!0),N.reload};return(0,i.jsxs)("article",{className:"p-3 lg:p-5 mb-5 bg-white border border-blue-600 rounded-md",children:[(0,i.jsx)("header",{className:"lg:flex justify-between mb-4",children:(0,i.jsxs)("div",{className:"mb-4 lg:mb-0",children:[(0,i.jsxs)("p",{className:"font-semibold",children:[(0,i.jsxs)("span",{children:["Order ID: ",null==f?void 0:f._id," "]}),(null==f?void 0:f.orderStatus)=="Processing"?(0,i.jsxs)("span",{className:"text-red-500",children:["• ",null==f?void 0:f.orderStatus.toUpperCase()]}):(0,i.jsxs)("span",{className:"text-green-500",children:["• ",null==f?void 0:f.orderStatus.toUpperCase()]})]}),(0,i.jsxs)("p",{className:"text-gray-500",children:[null==f?void 0:null===(l=f.createAt)||void 0===l?void 0:l.substring(0,10)," "]})]})}),(0,i.jsxs)("div",{className:"grid md:grid-cols-3 gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-gray-400 mb-1",children:"Person"}),(0,i.jsxs)("ul",{className:"text-gray-600",children:[(0,i.jsx)("li",{children:null==f?void 0:null===(s=f.user)||void 0===s?void 0:s.name}),(0,i.jsxs)("li",{children:["Phone: ",null==f?void 0:null===(r=f.shippingInfo)||void 0===r?void 0:r.phoneNo]}),(0,i.jsxs)("li",{children:["Email: ",null==f?void 0:null===(c=f.user)||void 0===c?void 0:c.email]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-gray-400 mb-1",children:"Delivery address"}),(0,i.jsxs)("ul",{className:"text-gray-600",children:[(0,i.jsx)("li",{children:null==f?void 0:null===(u=f.shippingInfo)||void 0===u?void 0:u.street}),(0,i.jsxs)("li",{children:[null==f?void 0:null===(v=f.shippingInfo)||void 0===v?void 0:v.city,", ",null==f?void 0:null===(p=f.shippingInfo)||void 0===p?void 0:p.state,","," ",null==f?void 0:null===(h=f.shippingInfo)||void 0===h?void 0:h.zipCode]}),(0,i.jsx)("li",{children:null==f?void 0:null===(m=f.shippingInfo)||void 0===m?void 0:m.country})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-gray-400 mb-1",children:"Payment"}),(0,i.jsxs)("ul",{className:"text-gray-600",children:[(0,i.jsx)("li",{className:"text-green-400",children:null==f?void 0:null===(x=f.paymentInfo)||void 0===x?void 0:null===(g=x.status)||void 0===g?void 0:g.toUpperCase()}),(0,i.jsxs)("li",{children:["Tax paid: $",null==f?void 0:null===(j=f.paymentInfo)||void 0===j?void 0:j.taxPaid]}),(0,i.jsxs)("li",{children:["Total paid: $",null==f?void 0:null===(b=f.paymentInfo)||void 0===b?void 0:b.amountPaid]})]})]})]}),(0,i.jsx)("hr",{className:"my-4"}),(0,i.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-2",children:null==f?void 0:null===(y=f.orderItems)||void 0===y?void 0:y.map(e=>(0,i.jsxs)("figure",{className:"flex flex-row mb-4",children:[(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"block w-20 h-20 rounded border border-gray-200 overflow-hidden p-3",children:(0,i.jsx)(d(),{src:null==e?void 0:e.image,height:"60",width:"60",alt:e.name})})}),(0,i.jsxs)("figcaption",{className:"ml-3",children:[(0,i.jsx)("p",{children:e.name.substring(0,35)}),(0,i.jsxs)("p",{className:"mt-1 font-semibold",children:[e.quantity,"x = $",e.price*e.quantity]})]})]}))}),(0,i.jsx)("hr",{}),(0,i.jsxs)("div",{className:"my-8",children:[(0,i.jsx)("label",{className:"block mb-3",children:" Update Order Status "}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("select",{className:"block appearance-none border border-gray-200 bg-gray-100 rounded-md py-2 px-3 hover:border-gray-400 focus:outline-none focus:border-gray-400 w-full",name:"category",value:P,onChange:e=>S(e.target.value),required:!0,children:["Processing","Shipped","Delivered"].map(e=>(0,i.jsx)("option",{value:e,children:e},e))}),(0,i.jsx)("i",{className:"absolute inset-y-0 right-0 p-2 text-gray-400",children:(0,i.jsx)("svg",{width:"22",height:"22",className:"fill-current",viewBox:"0 0 20 20",children:(0,i.jsx)("path",{d:"M7 10l5 5 5-5H7z"})})})]})]}),(0,i.jsx)("button",{type:"submit",className:"mb-2 px-4 py-2 text-center w-full inline-block text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700",onClick:()=>O(),children:"Update Order"})]})};l.default=c},8747:function(e,l,s){"use strict";s.d(l,{u:function(){return t}});var i=s(1844),n=s(8433),r=s(9332),d=s(5784);let a=(0,d.createContext)(),t=e=>{let{children:l}=e,[s,t]=(0,d.useState)(null),[o,c]=(0,d.useState)(!1),[u,v]=(0,d.useState)(!1),p=(0,r.useRouter)(),h=async(e,l)=>{try{let{data:s}=await n.Z.put("".concat("https://npmbuycom-c8fjodpc4-nikkcartwrights-projects.vercel.app","/api/admin/orders/").concat(e),l);s.success&&(c(!0),p.replace("/admin/orders/".concat(e)))}catch(e){var s,i;t(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(i=s.data)||void 0===i?void 0:i.message)}},m=async e=>{try{let{data:l}=await n.Z.delete("".concat("https://npmbuycom-c8fjodpc4-nikkcartwrights-projects.vercel.app","/api/admin/orders/").concat(e));(null==l?void 0:l.success)&&p.replace("/admin/orders")}catch(e){var l,s;t(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.message)}},x=async e=>{try{let{data:l}=await n.Z.get("".concat("https://npmbuycom-c8fjodpc4-nikkcartwrights-projects.vercel.app","/api/orders/can_review?productId=").concat(e));(null==l?void 0:l.canReview)&&v(null==l?void 0:l.canReview)}catch(e){var l,s;t(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.message)}},g=()=>{t(null)};return(0,i.jsx)(a.Provider,{value:{error:s,updated:o,canReview:u,canUserReview:x,setUpdated:c,updateOrder:h,deleteOrder:m,clearErrors:g},children:l})};l.Z=a},4825:function(e,l,s){"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.RouterContext=void 0;var i=(0,s(2648).Z)(s(5784));let n=i.default.createContext(null);l.RouterContext=n}},function(e){e.O(0,[996,675,497,17,744],function(){return e(e.s=809)}),_N_E=e.O()}]);